<div class="border position-relative p-2 h-100 w-100">
    <div class="text-right chart-actions">
        <!-- <i class="icon-cog" (click)="onClickOfCustomizeImageOverlay()"></i> -->
        <a (click)="onClickOfCustomizeImageOverlay()" [class.d-none]="locked"><i class="icon-cog"></i></a>
    </div>
    <div class="text-center con-wid-preview" *ngIf="!isImageOverlayConfigured">
        <img class="img-fluid img-fluid-custom" src="../../../../assets/images/configure_image_overlay_widget.jpg">
    </div>
    <div *ngIf="isImageOverlayConfigured" id="{{ 'image-overlay' + wId }}" class="h-100 w-100">
        <!-- <div class="h-100 assoc-pane">
            <img *ngIf="widgetimgURL" [src]="widgetimgURL" class="assoc-img img-fluid img-fluid-custom" />

            <div id="sig_{{i}}" *ngFor="let item of associatedSignals; let i = index;" [ngClass]="item.icon"
                [ngStyle]="getPositionStyle(item)">
                <div class="signal-data-wrapper">
                  <p><b>QCD > Chetak > NoCam 5122</b></p>
                  <p>09/13/2019 11:45PM</p>
                  <p><b>Critical alarm on asset</b></p>
                  <hr class="mt-1 mb-1">
                  <p><b>{{item.associationName}}</b></p>
                  <p>Temprature : 142&deg; F</p>
                  <p>Above critical threshold of 95&deg; F</p>
                </div>
            </div>

        </div> -->

        <div class=" h-100 assoc-pane" (window:resize)="onResize($event)">
            <!--  [src]="imgURL" -->
            <img #overlayImage [src]="widgetimgURL" class="assoc-img" (load)="onLoadLocImg()"  />
            <ng-container *ngFor="let item of associatedSignals; let i = index;">
              <div
                id="sig_{{i}}"
                *ngIf="item.sensorLinkStatus"
                style="position: absolute;"
                class="signal-item {{ item.icon }} active"
                [style.left.px]="imgOffsetLeft + item.imageCordinates[item.associationName].x * imgOffsetWidth - 16"
                [style.top.px]="imgOffsetTop + item.imageCordinates[item.associationName].y * imgOffsetHeight - 16"
              >
              {{item.associationName}} : {{item.latestValue}}
                  <!-- <p><b>QCD > {{item.locationName}}</b></p>
                  <p>09/13/2019 11:45PM</p>
                  <p><b>Critical alarm on asset</b></p>
                  <hr class="mt-1 mb-1">
                  <p><b>{{item.associationName}}</b></p>
                  <p>{{item.associationName}} : {{item.latestValue}}</p>
                  <p>Above critical threshold of 95&deg; F</p> -->
              </div>
            </ng-container>
            <div
              id="asset_{{i}}"
              *ngFor="let item of associatedAssets; let i = index;"
              style="position: absolute;"
              class="signal-item {{ item.icon }}"
              [style.left.px]="imgOffsetLeft + item.imageCoordinates[overLaySource === 'location' ? item.assetId : item.childAssetId].x * imgOffsetWidth - 16"
              [style.top.px]="imgOffsetTop + item.imageCoordinates[overLaySource === 'location' ? item.assetId : item.childAssetId].y * imgOffsetHeight - 16"
            >
              {{overLaySource === 'location' ? item.assetName : item.childAssetName}}

            </div>
          </div>

    </div>
</div>

<!-- Modal Image Overlay Config-->
<div id="configure-image-overlay-modal-{{wId}}" class="modal">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
            <form name="dashBoardConfigurationForm" #dashBoardConfigurationForm="ngForm"
                (ngSubmit)="saveImageOverlayConfiguration()">
                <div class="modal-header">
                    <h5 class="modal-title">Image Overlay Configuration</h5>
                    <button type="button" class="close"
                        (click)="onClickOfCustomizeImageOverlayModalClose()">&times;</button>
                </div>
                <div class="modal-body">

                    <div class="row">
                        <div class="col-3">
                            <div class="form-group">
                                <label for="">Title:</label>
                                <input class="form-control form-control-sm" type="text" name="widgetTitle"
                                    [(ngModel)]="widgetTitle" placeholder="" />
                            </div>
                        </div>
                        <div class="col-3">
                            <div class="form-group">
                                <label for="">Overlay Source:</label>
                                <div class="">
                                    <ng-select id="imageSource" name="imageSource" labelForId="imageSource"
                                        class="custom" [multiple]="false" [(ngModel)]="overLaySource" placeholder="Choose Source"
                                        (change)="signalsCheckboxChecked = true; assetsCheckboxChecked = true;associatedAssets = []; associatedSignals=[]">
                                        <ng-option value="location">Location</ng-option>
                                        <ng-option value="asset">Asset</ng-option>
                                        <ng-option value="custom">Custom</ng-option>
                                    </ng-select>
                                </div>
                            </div>
                        </div>
                        <div class="col-3" *ngIf="overLaySource === 'location'" >
                            <div class="form-group">
                                <label for="widgetlocImageID">Location</label>
                                <div class="">
                                    <ng-select id="widgetlocImageID" name="widgetlocImageID" labelForId="widgetlocImageID"
                                        class="custom" [multiple]="false" [(ngModel)]="widgetlocImageID"
                                        placeholder="Choose Location">
                                        <ng-option *ngFor="let locationChild of LocationSourceChild" [value]="locationChild.data.id">{{locationChild.data.name}}</ng-option>
                                    </ng-select>
                                </div>
                            </div>
                        </div>
                        <div class="col-3" *ngIf="overLaySource === 'asset'" >
                            <div class="form-group">
                                <label for="">Asset</label>
                                <div class="">
                                    <ng-select id="widgetassetimageID" name="widgetassetimageID" labelForId="widgetassetimageID" class="custom"
                                        [multiple]="false" [(ngModel)]="widgetassetimageID" placeholder="Choose Asset">
                                        <ng-option *ngFor="let assetsChild of assetsSourceChild" [value]="assetsChild.data.id">{{assetsChild.data.name}}</ng-option>
                                    </ng-select>
                                </div>
                            </div>
                        </div>
                        <div class="col-3">
                            <div class="form-group">
                                <label for="">Icon Display Size</label>
                                <div class="">
                                    <ng-select id="iconSize" name="iconSize" labelForId="iconSize" class="custom"
                                        [multiple]="false" [(ngModel)]="iconSize" placeholder="Choose Size">
                                        <ng-option value="widget-icon-extra-small">X-S</ng-option>
                                        <ng-option value="widget-icon-small">S</ng-option>
                                        <ng-option value="widget-icon-medium">M</ng-option>
                                        <ng-option value="widget-icon-large">L</ng-option>
                                        <ng-option value="widget-icon-extra-large">XL</ng-option>
                                        <ng-option value="widget-icon-extra-extra-large">XXL</ng-option>
                                    </ng-select>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row" *ngIf="overLaySource === 'location'" >
                        <div class="col-4">
                            <div class="custom-control custom-switch">
                                <input type="checkbox" class="custom-control-input" id="locSignal" [(ngModel)]="signalsCheckboxChecked" name="locSignal">
                                <label class="custom-control-label" for="locSignal" id="locSignalLbl">Show Location
                                    Signals?</label>
                            </div>
                        </div>
                        <div class="col-4">
                            <div class="custom-control custom-switch">
                                <input type="checkbox" class="custom-control-input" [(ngModel)]="assetsCheckboxChecked" id="assetLocAssociated"
                                    name="assetLocAssociated">
                                <label class="custom-control-label" for="assetLocAssociated"
                                    id="assetLocAssociatedLbl">Show Assets?</label>
                            </div>
                        </div>
                    </div>
                    <div class="row" *ngIf="overLaySource === 'asset'" >
                        <div class="col-4">
                            <div class="custom-control custom-switch">
                                <input type="checkbox" [(ngModel)]="signalsCheckboxChecked" class="custom-control-input" id="locAssetSignal"
                                    name="locAssetSignal">
                                <label class="custom-control-label" for="locAssetSignal" id="locAssetSignalLbl">Show
                                    asset signals?</label>
                            </div>
                        </div>
                        <div class="col-4">
                            <div class="custom-control custom-switch">
                                <input type="checkbox" [(ngModel)]="assetsCheckboxChecked" class="custom-control-input" id="childassetLocAssociated"
                                name="locChildAsset">
                                <label class="custom-control-label" for="childassetLocAssociated"
                                    id="childassetLocAssociatedLbl">Show Child Assets?</label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-secondary btn-sm" id="imageOverlayCancelBtn"
                        (click)="onClickOfCustomizeImageOverlayModalClose()">Cancel</button>
                    <button type="submit" class="btn btn-info btn-sm" id="configSave">
                        Save
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
