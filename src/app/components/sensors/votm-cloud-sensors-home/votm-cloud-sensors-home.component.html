
<h3 class="flt-left sensor-header"> Sensors</h3>
<div class="btn-group-right">
    <button [routerLink]="['/sensor/detail']" type="button" class="btn btn-dark">Configure Sensors</button>
</div>

<ng-template #recursiveTableList let-list="sensorList" let-lvl="level">
  <ng-container *ngFor="let item of list">

    <tr>
      <th scope="row" (click)="item.opened = !item.opened" [ngStyle]="{'padding-left.px': 15*(lvl+1)}">
        <i class="fa fa-thermometer-half"></i>
        {{item.name}} <i *ngIf="item || item.node.length > 0 " 
          [ngClass]="{'fa': true, 'fa-caret-right': !item.opened, 'fa-caret-down': item.opened}"></i>
      </th>
      <td class="align-center" >{{item.serialNumber}}</td>
      <td class="align-center" >{{item.assetNumber}}</td>
      <td class="align-center" ></td>
      <td class="align-center" ></td>
      <td class="align-center" ></td>
      <td class="align-center" ></td>
      <td class="align-center" ></td>
      <td class="align-center">
        <a class="action-icon" title="List" [routerLink]="['/sensor/home', item.id]">
          <i class="fa fa-list"></i>
        </a>
        <a class="action-icon" title="View" [routerLink]="['/sensor/view']">
          <i class="fa fa-eye"></i>
        </a>
        <a class="action-icon" title="Edit" [routerLink]="['/sensor/edit']">
          <i class="fa fa-edit"></i>
        </a>
        <a class="action-icon" (click)="openConfirmDialog(item.id)" title="Delete">
          <i class="fa fa-trash"></i>
        </a>
      </td>
    </tr>
    
    <ng-container  *ngFor="let subItem of item.node">
      <tr *ngIf="item.opened && subItem.entityType == 'Sensor'" >
        <th scope="row" [ngStyle]="{'padding-left.px': 15*(lvl+2)}"> <i class="fa fa-location-arrow"></i> {{subItem.name}}</th>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td class="align-center">
          <a class="action-icon">
            <i class="fa fa-list"></i>
          </a>
        </td>
      </tr>

        
      <tr *ngIf="item.opened && subItem.entityType == 'Sensor'">
        <th scope="row" (click)="subItem.opened = !subItem.opened" [ngStyle]="{'padding-left.px': 15*(lvl+2)}">
          <i class="fa fa-thermometer-half"></i>
          {{subItem.sensorName}} <i *ngIf="subItem.node.length > 0 " [ngClass]="{'fa': true, 'fa-caret-right': !subItem.opened, 'fa-caret-down': subItem.opened}"></i>
        </th>
        <td class="align-center" >{{subItem.serialNumber}}</td>
        <td class="align-center" ></td>
        <td class="align-center" ></td>
        <td class="align-center" ></td>
        <td class="align-center" ></td>
        <td class="align-center" ></td>
        <td class="align-center" ></td>
        <td class="align-center">
          <a class="action-icon" title="List" [routerLink]="['/sensor/home', subItem.id]">
            <i class="fa fa-list"></i>
          </a>
          <a class="action-icon" title="View" [routerLink]="['/sensor/view']">
            <i class="fa fa-eye"></i>
          </a>
          <a class="action-icon" title="Edit" [routerLink]="['/sensor/edit']">
            <i class="fa fa-edit"></i>
          </a>
          <a class="action-icon" (click)="openConfirmDialog(subItem.id)" title="Delete">
            <i class="fa fa-trash"></i>
          </a>
        </td>
      </tr>

      <ng-container *ngIf="subItem.opened">
          <ng-container *ngTemplateOutlet="recursiveTableList; context:{ sensorList: subItem.node, level: lvl+2 }"></ng-container>
      </ng-container>
      
    </ng-container>
    
  </ng-container>
</ng-template>


<table class="table table-sm table-bordered sensor-table-fonts">
    <thead class="thead-light">
      <tr>
        <th scope="col" class="align-center table-col-name" >Sensor/Signal Name</th>
        <th scope="col" class="align-center" >Serial #</th>
        <th scope="col" class="align-center" >Sensor Type</th>
        <th scope="col" class="align-center table-col-small" >Location</th>
        <th scope="col" class="align-center table-col-small" >Organization</th>
        <th scope="col" class="align-center table-col-small" >Reported Value</th>
        <th scope="col" class="align-center table-col-small" >Last Reported Time</th>
        <th scope="col" class="align-center table-col-small" >State</th>
        <th scope="col" class="align-center" >Actions</th>
      </tr>
    </thead>
    <tbody>
        <ng-container *ngTemplateOutlet="recursiveTableList; context:{ sensorList: sensorList, level: 0 }"></ng-container>
    </tbody>
  </table>


  <app-votm-cloud-confim-dialog (onClose)="deleteSensorById($event)" #confirmBox
  message="Do you want to delete the Asset?" headerMessage="Warning"></app-votm-cloud-confim-dialog>
