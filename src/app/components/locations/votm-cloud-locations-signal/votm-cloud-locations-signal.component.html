<div class="position-relative">
  <div class="row">
    <div class="col-12 col-md-4">
      <div class="form-group has-search">
        <span class="icon-search form-control-feedback"></span>
        <input type="text" class="form-control" placeholder="Filter Signals" />
      </div>
    </div>
    <div class="col-12 col-md-8 form-group py-1">
      Signals to show:&nbsp;&nbsp;
      <div class="custom-control custom-checkbox custom-control-inline">
        <input type="checkbox" id="assocSignals" class="custom-control-input" [checked]="showAssoc" (change)="showAssoc = !showAssoc" />
        <label class="custom-control-label" for="assocSignals">Associated</label>
      </div>
      <div class="custom-control custom-checkbox custom-control-inline">
        <input type="checkbox" id="unassocSignals" class="custom-control-input" [checked]="showUnassoc" (change)="showUnassoc = !showUnassoc" />
        <label class="custom-control-label" for="unassocSignals">Unassociated</label>
      </div>
    </div>
  </div>
  <div class="embed-responsive embed-responsive-16by9">
    <div class="embed-responsive-item">
      <div class="drag-root row h-100">
        <div class="col-12 col-md-3 h-100">
          <div class="sensor-list h-100">
            <div *ngIf="showSensor(derivedSignals) || showUnassoc" class="icon-sig-function derived">
              Calculated Signals <button type="button" class="btn btn-sm" (click)="addDerived()"><i class="icon-plus"></i></button>
              <div class="signal-list">
                <ng-container *ngFor="let signal of derivedSignals">
                  <div
                    class="{{ signal.icon }}"
                    *ngIf="showSignal(signal)"
                    [ngClass]="{ assoc: signal.associated }"
                    [dndDraggable]="signal"
                    [dndDisableIf]="signal.associated"
                    [dndEffectAllowed]="'move'"
                    (dndStart)="onStart($event)"
                  >
                    {{ signal.name }}
                  </div>
                </ng-container>
              </div>
            </div>
            <ng-container *ngFor="let sensor of sensors; let i = index">
              <div *ngIf="showSensor(sensor.node)" class="icon-sensonode">
                {{ sensor.name }}
                 <!-- - {{ sensor.sensorType }} -->
                <div class="signal-list">
                  <ng-container *ngFor="let signal of sensor.node; let j = index">
                    <div
                      attr.sensorIx="{{ i }}"
                      attr.signalIx="{{ j }}"
                      class="{{ signal.icon }}"
                      *ngIf="showSignal(signal)"
                      [ngClass]="{ assoc: signal.associated }"
                      [dndDraggable]="signal"
                      [dndDisableIf]="signal.associated"
                      [dndEffectAllowed]="'move'"
                      (dndStart)="onStart($event, i, j)"
                    >
                      {{ signal.signalName }}
                    </div>
                  </ng-container>
                </div>
              </div>
            </ng-container>
          </div>
        </div>
        <div class="col-12 col-md-9 pl-md-0 h-100">
          <div class="border h-100 assoc-container">
            <div class="assoc-pane">
              <img *ngIf="imgURL"  [src]="imgURL" class="assoc-img" dndDropzone (dndDrop)="onDrop($event)" />
              <div
                *ngFor="let item of associatedSignals; let i = index;"
                [ngClass]="!item.isClicked ? 'pad-l-1 ' + item.icon : item.icon"
                [ngStyle]="item.pos"
                [dndDraggable]="item"
                [dndEffectAllowed]="'move'"
                (dndStart)="onStart($event, i)"
                (click)="onClickOfAssociatedSignal(item)"
              >
              <ng-container *ngIf="!item.isClicked" >
                &#8203;
              </ng-container>
              <ng-container *ngIf="item.isClicked">
                {{selectedSignal ? selectedSignal.associationName : ''}}
                <a (click)="onClickOfEditIcon(i, $event)"><i class="icon-edit cursor-point"></i></a>
                <a (click)="onClickOfAlertIcon(i, $event)"><i class="icon-warn cursor-point"></i></a>
                <a (click)="onDetachSignalFromAsset(i)"><i class="icon-unlink cursor-point"></i></a>
              </ng-container>
              </div>

            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="ml-auto mr-3 mt-3">
    <button id="loc-sig-cancel" for="form-cancel" type="button" (click)="onCancelClick($event)"
      class="btn btn-outline-secondary btn-sm mr-2">Cancel</button>
    <button id="loc-signal-association-save" type="button" class="btn btn-info btn-sm" (click)="onSaveSignalAssociation()"
      [disabled]="associatedSignals.length === 0 || isSignalAssociationAPILoading">
      Save<i *ngIf="isSignalAssociationAPILoading" class="fa fa-spinner fa-spin fa-fw"></i>
    </button>
  </div>
</div>

<!-- <hr>
<div class="row">
  <div id="sensor-cont" class="col-md-2"></div>
  <div class="col-md-10">
      <div class="chart-cont embed-responsive embed-responsive-16by9" style="background-color: #efefef;">
          <div class="embed-responsive-item" id="map-cont-1">
              <img *ngIf="imgURL"  id="map-image" class="img-fluid" [src]="imgURL" />
          </div>
      </div>
  </div>
  <div class="ml-auto mr-3 mt-3">
    <button id="loc-sig-cancel" for="form-cancel" type="button" (click)="onCancelClick($event)"
      class="btn btn-outline-secondary btn-sm mr-2">Cancel</button>
    <button id="loc-signal-association-save" type="button" class="btn btn-info btn-sm" (click)="onSaveSignalAssociation()"
      [disabled]="associatedSignals.length === 0 || isSignalAssociationAPILoading">
      Save<i *ngIf="isSignalAssociationAPILoading" class="fa fa-spinner fa-spin fa-fw"></i>
    </button>
  </div>

</div> -->


<p-overlayPanel #editOP [appendTo]="'body'" [style]="{ 'width' : '300px', 'z-index': '9999!important'}" [dismissable]="false"
[showCloseIcon]="true">
  <div class="row"  *ngIf="selectedSignal">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header">Signal Association</div>
            <div class="card-body">
              <div class="row">
                <div class="col-md-12">
                  <div class="form-group">
                    <label class="temp" id="edit-panel-name-label">Name: </label>
                    <div class="">
                      <input type="text" class="form-control form-control-sm" id="edit-panel-name" placeholder="Enter Signal Name"
                      [(ngModel)]="selectedSignal.associationName">
                    </div>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-group">
                    <label class="temp" id="edit-panel-x-label">Position: &nbsp; X</label>
                    <div class="">
                      <input type="text" id="edit-panel-position-x" class="form-control form-control-sm" [(ngModel)]="selectedSignal.imageCordinates.x" placeholder="Enter Postion X">
                    </div>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-group">
                    <label class="temp" id="edit-panel-y-label">Position: &nbsp; Y</label>
                    <div class="">
                      <input type="text" id="edit-panel-position-y" class="form-control form-control-sm" [(ngModel)]="selectedSignal.imageCordinates.y" placeholder="Enter Position Y">
                    </div>
                  </div>
                </div>
                <!-- <div class="col-md-12">
                  <div class="form-group">
                    <label class="temp" id="edit-panel-x-label">Source Signal Type: </label>
                    <div class="">
                      {{selectedSignal.name}}
                    </div>
                  </div>
                </div>
                <div class="col-md-12">
                  <div class="form-group">
                    <label class="temp" id="edit-panel-x-label">Source Sensor: </label>
                    <div class="">
                      {{selectedSignal.sensorName}}
                    </div>
                  </div>
                </div> -->
                <div class="row-flex mar-top-5">
                  <div class="col-sm-12">
                  <label> Source Signal Type: </label> {{selectedSignal.name}}
                  </div>
                </div>
                <div class="row-flex mar-top-5">
                  <div class="col-sm-12">
                  <label> Source Sensor: </label> {{selectedSignal.sensorName}}
                  </div>
                </div>

              </div>
            </div>
            <div class="card-footer text-muted">
                <button class="btn btn-sm btn-info pull-right" id="sigSave" (click)="onClickOfSaveSignalAssociationPanel($event)">Save</button>
                <button class="btn btn-sm btn-outline-secondary pull-right mr-1" id="sigClose" (click)="closeEditOpanel()">Close</button>
            </div>
        </div>
    </div>
</div>
</p-overlayPanel>

<p-overlayPanel #alertOP [appendTo]="'body'" [style]="{ 'width' : '300px'}" [dismissable]="false"
[showCloseIcon]="true">
  <div class="row"  *ngIf="selectedSignal">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header">Alarm Rule Association</div>
            <div class="card-body">
              <div class="row">
                <div class="col-md-12">
                  <div class="form-group">
                    <label class="temp" id="edit-panel-name-label">Add Rule: </label>
                    <div class="">
                      <select  class="form-control form-control-sm" id="alert-panel-rule-name" [(ngModel)]="selectedAlertRule">
                        <option>Select Any</option>
                        <option *ngFor="let rule of alertRules" [ngValue]="rule">{{rule.alertRuleName}}</option>
                      </select>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="card-footer text-muted">
                <button class="btn btn-sm btn-info pull-right" (click)="onClickOfAlarmRuleAssociation()" id="alertSave" [disabled]="isAlarmRuleAssociationAPILoading">Save<i *ngIf="isAlarmRuleAssociationAPILoading" class="fa fa-spinner fa-spin fa-fw"></i>
                </button>
                <button class="btn btn-sm btn-outline-secondary pull-right mr-1" id="alertCreate" (click)="onClickOfCreateAssociateRule()">Create & Associate Rule</button>
            </div>
        </div>
    </div>
</div>
</p-overlayPanel>


<!-- Modal for Favorite  -->
<div id="alertModal" class="modal">
    <div class="modal-dialog modal-lg modal-dialog-scrollable modal-dialog-centered">
      <!-- Modal content -->
      <div class="modal-content">
            <app-votm-cloud-alerts-create></app-votm-cloud-alerts-create>
     
      
      </div>
    </div>
  </div>
<!-- <app-votm-cloud-alerts-create></app-votm-cloud-alerts-create>   (click)="openmodal()"-->



