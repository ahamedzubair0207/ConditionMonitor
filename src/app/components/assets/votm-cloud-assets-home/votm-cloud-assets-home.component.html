<ul class="nav nav-tabs" id="myTab" role="tablist">
  <li class="nav-item">
    <a class="nav-link active" id="asset-tab" data-toggle="tab" href="#assetListTabContent" role="tab"
      aria-controls="assetListTabContent" aria-selected="true">Asset</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" id="template-tab" data-toggle="tab" href="#templateListTabContent" role="tab"
      aria-controls="templateListTabContent" (click)="onTemplateTabClick()" aria-selected="false">Template</a>
  </li>
</ul>
<div class="tab-content" id="myTabContent">
  
  <div class="tab-pane fade show active" id="assetListTabContent" role="tabpanel" aria-labelledby="asset-tab">
    <!-- <form class="form-container border shadow-lg asset-table-fonts"> -->

    <!-- <h3 class="flt-left mt-3 mb-3 ml-2 asset-table-header"> List</h3> -->
    <button class="btn btn-info btn-group-right btn-sm asset-table-header"  (click)="onCreateAsset()" id="createAssetButton" type="button"><i
        class="fa fa-industry mr-2"></i>Create Asset</button>
        <!-- [routerLink]="['/asset/create',parentOrgId, parentOrgName]" -->
    <form class="form-inline">
      <label for="typeahead-config">Type to filter events:</label>
      <input class="form-control ml-2 mb-3 mt-3" id="searchBox" type="search" placeholder="Search" aria-label="Search">
      <button class="btn btn-outline-info mr-2 ml-2" id="searchButton" type="submit">Search</button>
      <!-- <button class="btn btn-info" id="createAssetButton" type="submit"><i class="fa fa-industry mr-2"></i>Create Asset</button>  -->
    </form>

    <ng-template #recursiveTableList let-list="assetList" let-lvl="level">
      <ng-container *ngFor="let item of list">
        <tr>
          <th scope="row" (click)="item.opened = !item.opened" [ngStyle]="{'padding-left.px': 15*(lvl+1)}">
            <i class="fa fa-industry"></i>
            {{item.name}}
            <i *ngIf="item.node.length > 0 "
              [ngClass]="{'fa': true, 'fa-caret-right': !item.opened, 'fa-caret-down': item.opened}"></i>
          </th>
          <td class="align-left">{{item.type}}</td>
          <td class="align-left">{{item.assetNumber}}</td>
          <td class="align-left">{{item.parentLocationName}}</td>
          <td class="align-left">{{item.parentOrganizationName}}</td>
          <td class="align-left"></td>
          <td class="align-left"></td>
          <td class="align-left"></td>
          <td class="align-center">
            <!-- <a class="action-icon" title="List" (click)="onListClick(item)"> -->
            <a class="action-icon" title="List">
              <i class="fa fa-list"></i>
            </a>

            <a class="action-icon" title="View" (click)="onEditViewClick(item, 'view')">

              <i class="fa fa-eye"></i>
            </a>
            <!-- [routerLink]="['/asset/view',item.parentOrganizationId, item.parentOrganizationName, item.parentLocationId, item.parentLocationName, item.id]"> -->
            <a class="action-icon" title="Edit" (click)="onEditViewClick(item, 'edit')">
              <i class="fa fa-edit"></i>
            </a>
            <a class="action-icon" (click)="openConfirmDialog(item.id, item.name)" title="Delete">
              <i class="fa fa-trash"></i>
            </a>
          </td>
        </tr>

        <ng-container *ngFor="let subItem of item.node">
          <!-- <tr *ngIf="item.opened && subItem.entityType == 'Asset'">
                  <th scope="row" [ngStyle]="{'padding-left.px': 15*(lvl+2)}"> <i class="fa fa-industry"></i>
                    {{subItem.name? subItem.name : 'Ahamed'}}</th>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td class="align-center">
                    <a class="action-icon">
                      <i class="fa fa-list"></i>
                    </a>
                  </td>
                </tr> -->


          <tr *ngIf="item.opened && subItem.entityType == 'Asset'">
            <th scope="row" (click)="subItem.opened = !subItem.opened" [ngStyle]="{'padding-left.px': 15*(lvl+2)}">
              <i class="fa fa-industry"></i>
              <!-- Ahamed -->
              {{subItem.name}}
              <i *ngIf="subItem.node.length > 0 "
                [ngClass]="{'fa': true, 'fa-caret-right': !subItem.opened, 'fa-caret-down': subItem.opened}"></i>
            </th>
            <td class="align-left">{{subItem.type}}</td>
            <td class="align-left">{{subItem.assetNumber}}</td>
            <td class="align-left">{{subItem.parentLocationName}}</td>
            <td class="align-left">{{subItem.parentOrganizationName}}</td>
            <td class="align-left"></td>
            <td class="align-left"></td>
            <td class="align-left"></td>
            <td class="align-center">
              <a class="action-icon" title="List" (click)="onListClick(subItem)">
                <!-- [routerLink]="['/asset/home',subItem.parentOrganizationId, subItem.parentOrganizationName, subItem.id]"> -->
                <i class="fa fa-list"></i>
              </a>
              <!-- <a class="action-icon" title="List" (click)="getIntoContext(subItem)"
                      [routerLink]="['/asset/home',subItem.parentOrganizationId, subItem.parentOrganizationName, subItem.parentLocationNaId, subItem.parentLocationName, subItem.id, subItem.name]">
                      <i class="fa fa-list"></i>
                    </a> -->
              <a class="action-icon" title="View" (click)="onEditViewClick(subItem, 'view')">
                <i class="fa fa-eye"></i>
              </a>
              <!-- [routerLink]="['/asset/view',subItem.parentOrganizationId, subItem.parentOrganizationName, subItem.parentLocationId, subItem.parentLocationName, subItem.parentId, subItem.parentName, subItem.id]" -->

              <a class="action-icon" title="Edit" (click)="onEditViewClick(subItem, 'edit')">
                <i class="fa fa-edit"></i>
              </a>
              <!-- [routerLink]="['/asset/edit',subItem.parentOrganizationId, subItem.parentOrganizationName, subItem.parentLocationId, subItem.parentLocationName,subItem.parentId, subItem.parentName, subItem.id]" -->
              <a class="action-icon" (click)="openConfirmDialog(subItem.id)" title="Delete">
                <i class="fa fa-trash"></i>
              </a>
            </td>
          </tr>

          <ng-container *ngIf="subItem.opened &&  subItem.node.length>0">
            <ng-container *ngTemplateOutlet="recursiveTableList; context:{ assetList: subItem.node, level: lvl+2 }">
            </ng-container>
          </ng-container>

        </ng-container>

      </ng-container>
    </ng-template>


    <table class="table table-sm table-bordered asset-table-fonts">
      <thead class="thead-dark">
        <tr>
          <th scope="col" class="align-left table-col-name">Name</th>
          <th scope="col" class="align-left">Type</th>
          <th scope="col" class="align-left">Asset ID</th>
          <th scope="col" class="align-left table-col-small">Location</th>
          <th scope="col" class="align-left table-col-small">Organization</th>
          <th scope="col" class="align-left table-col-small">Alarm State</th>
          <th scope="col" class="align-left table-col-small">Last Value</th>
          <th scope="col" class="align-left table-col-small">Last Reported Time</th>
          <th scope="col" class="align-center">Actions</th>
        </tr>
      </thead>
      <tbody>
        <ng-container *ngTemplateOutlet="recursiveTableList; context:{ assetList: assetsList, level: 0 }">
        </ng-container>
      </tbody>
    </table>
    <!-- </form> -->
    <!-- <div class="tab-pane fade" id="templates" role="tabpanel" aria-labelledby="profile-tab">Templates</div> -->
  </div>


  <div class="tab-pane fade" id="templateListTabContent" role="tabpanel" aria-labelledby="template-tab">
    <app-votm-cloud-asset-template-list [templateList]="templateList"></app-votm-cloud-asset-template-list>
  </div>

</div>



<app-votm-cloud-confim-dialog (onClose)="deleteAssetById($event)" #confirmBox message="{{message}}"
  headerMessage="Warning"></app-votm-cloud-confim-dialog>