import { Directive, Injectable, Component, ContentChild, ElementRef, EventEmitter, Input, Output, TemplateRef, ViewChild, ViewContainerRef, NgModule } from '@angular/core';
import { BehaviorSubject, of, Subject } from 'rxjs';
import { fromPromise } from 'rxjs/internal-compatibility';
import { __values } from 'tslib';
import { CommonModule } from '@angular/common';

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
var AtlasPopupDirective = /** @class */ (function () {
    function AtlasPopupDirective() {
    }
    AtlasPopupDirective.decorators = [
        { type: Directive, args: [{
                    selector: '[amPopup]'
                },] },
    ];
    /** @nocollapse */
    AtlasPopupDirective.ctorParameters = function () { return []; };
    return AtlasPopupDirective;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
/** @type {?} */
var sources = [
    {
        type: 'style',
        src: 'https://atlas.microsoft.com/sdk/css/atlas.min.css?api-version=1'
    },
    {
        type: 'script',
        src: 'https://atlas.microsoft.com/sdk/js/atlas.min.js?api-version=1'
    }
];
/**
 * @return {?}
 */
function _window() {
    return window;
}
/**
 * @param {?} source
 * @param {?} type
 * @return {?}
 */
function loadSingleAsset(source, type) {
    return new Promise(function (resolve, reject) {
        /** @type {?} */
        var createdElement;
        switch (type) {
            case 'script':
                createdElement = document.createElement('script');
                createdElement.src = source;
                break;
            case 'style':
                createdElement = document.createElement('link');
                createdElement.rel = 'stylesheet';
                createdElement.href = source;
                createdElement.type = 'text/css';
                break;
            default:
                reject('Wrong Type');
                break;
        }
        if (typeof (_window().atlas) !== 'undefined'
            && typeof (_window().atlas.Map) !== 'undefined') {
            resolve();
        }
        else {
            createdElement.onerror = reject;
            createdElement.onload = resolve;
            document.head.appendChild(createdElement);
        }
    });
}
/**
 * @return {?}
 */
function azureMapLazyLoader() {
    return Promise.all(sources.map(function (source) { return loadSingleAsset(source.src, source.type); }));
}

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
var LoadMapService = /** @class */ (function () {
    function LoadMapService() {
        this.isLoaded = false;
        this.isComponentLoaded = false;
        this.loadedSubject = new Subject();
        this.loadedComponenet = new BehaviorSubject(false);
    }
    /**
     * @return {?}
     */
    LoadMapService.prototype.load = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (!this.isLoaded) {
            return fromPromise(azureMapLazyLoader().then(function () {
                _this.isLoaded = true;
                return _this.isLoaded;
            }));
        }
        else {
            return of(true);
        }
    };
    /**
     * @return {?}
     */
    LoadMapService.prototype.observableComponent = /**
     * @return {?}
     */
    function () {
        return this.loadedSubject.asObservable();
    };
    LoadMapService.decorators = [
        { type: Injectable },
    ];
    /** @nocollapse */
    LoadMapService.ctorParameters = function () { return []; };
    return LoadMapService;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
var AtlasMapComponent = /** @class */ (function () {
    function AtlasMapComponent(mapService) {
        this.mapService = mapService;
        this.onMapClick = new EventEmitter();
        this.loaded = new EventEmitter();
        this.customPins = [];
        this.features = [];
        this.pointsArray = [];
        this.cssArray = [];
    }
    /**
     * @return {?}
     */
    AtlasMapComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.popupAtlas = new atlas.Popup();
        this.mapService.loadedComponenet.next(true);
    };
    /**
     * @return {?}
     */
    AtlasMapComponent.prototype.ngAfterContentInit = /**
     * @return {?}
     */
    function () {
        this.createMap(this._id, this.initialConfig); // Initial map
        this.startMapClickListener(); // Start emitter
    };
    /**
     * @return {?}
     */
    AtlasMapComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        this.emitLoaded();
    };
    /**
     * @return {?}
     */
    AtlasMapComponent.prototype.emitLoaded = /**
     * @return {?}
     */
    function () {
        if (this.map) {
            this.loaded.emit();
        }
        else {
            setTimeout(this.emitLoaded, 100);
        }
    };
    /**
     * @param {?} id
     * @param {?} config
     * @return {?}
     */
    AtlasMapComponent.prototype.createMap = /**
     * @param {?} id
     * @param {?} config
     * @return {?}
     */
    function (id, config) {
        try {
            this.mapWrapper.nativeElement.setAttribute('id', id);
            this.map = new atlas.Map(id, config); // Init map box
            console.log('Map was created!', this.map);
        }
        catch (e) {
            console.log('CHECK YOUR CONFIG!', e);
        }
    };
    /**
     * @param {?} options
     * @return {?}
     */
    AtlasMapComponent.prototype.changeMapCamera = /**
     * @param {?} options
     * @return {?}
     */
    function (options) {
        this.map.setCamera(options);
    };
    /**
     * @param {?} options
     * @return {?}
     */
    AtlasMapComponent.prototype.changeMapStyle = /**
     * @param {?} options
     * @return {?}
     */
    function (options) {
        this.map.setStyle(options);
    };
    /**
     * @param {?} options
     * @return {?}
     */
    AtlasMapComponent.prototype.changeUserInteraction = /**
     * @param {?} options
     * @return {?}
     */
    function (options) {
        this.map.setUserInteraction(options);
    };
    /**
     * Founding all unique layers from features Array
     * @param AmFeature[] features
     * @returns string[]
     */
    /**
     * Founding all unique layers from features Array
     * @param {?} features
     * @return {?} string[]
     */
    AtlasMapComponent.prototype.findUniqueLayers = /**
     * Founding all unique layers from features Array
     * @param {?} features
     * @return {?} string[]
     */
    function (features) {
        /** @type {?} */
        var allLayers = features.map(function (it) { return it.layer; });
        return Array.from(new Set(allLayers));
    };
    /**
     * @return {?}
     */
    AtlasMapComponent.prototype.startMapClickListener = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.map.addEventListener('click', function (e) {
            _this.onMapClick.emit(e.position);
            // On click you emit geo position
        });
    };
    /**
     * Creating popUpContainer and injected to parent Template
     * @param context
     */
    /**
     * Creating popUpContainer and injected to parent Template
     * @param {?} context
     * @return {?}
     */
    AtlasMapComponent.prototype.createComponent = /**
     * Creating popUpContainer and injected to parent Template
     * @param {?} context
     * @return {?}
     */
    function (context) {
        if (this.popupView) {
            this.popupView.destroy();
        }
        this.popupView = this.popupsContainer.createEmbeddedView(this.popupTemplate, context);
    };
    /**
     * @param {?} id
     * @param {?} loc
     * @param {?} clas
     * @return {?}
     */
    AtlasMapComponent.prototype.addItem = /**
     * @param {?} id
     * @param {?} loc
     * @param {?} clas
     * @return {?}
     */
    function (id, loc, clas) {
        /** @type {?} */
        var customHTML;
        /** @type {?} */
        var idItem = clas + id;
        /** @type {?} */
        var pos = new atlas.data.Position(loc.lnt, loc.lng);
        this.cssArray.push(idItem); // Saving existing HTML elements
        customHTML = document.createElement('div');
        customHTML.setAttribute('id', idItem);
        customHTML.setAttribute('class', clas);
        this.map.addHtml(customHTML, pos); // add to map
    };
    /**
     * Drawin point on the map as pins
     * @Incjet createPopups()
     * @param  features
     */
    /**
     * Drawin point on the map as pins
     * \@Incjet createPopups()
     * @param {?} features
     * @return {?}
     */
    AtlasMapComponent.prototype.createPoints = /**
     * Drawin point on the map as pins
     * \@Incjet createPopups()
     * @param {?} features
     * @return {?}
     */
    function (features) {
        var e_1, _a;
        if (features.length === 0) {
            console.log('No data available');
            return;
        }
        try {
            for (var features_1 = __values(features), features_1_1 = features_1.next(); !features_1_1.done; features_1_1 = features_1.next()) {
                var item = features_1_1.value;
                this.map.addPins([item.atlasFeature], item.pinConfig);
                if (item.atlasFeature.properties.cssClass) {
                    this.addItem(item.dataElement.id, item.dataElement.localization, item.atlasFeature.properties.cssClass);
                    this.customPins.push(item.atlasFeature.properties.cssClass);
                }
                this.pointsArray.push(item.atlasFeature);
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (features_1_1 && !features_1_1.done && (_a = features_1.return)) _a.call(features_1);
            }
            finally { if (e_1) throw e_1.error; }
        }
        this.createPopups(features);
    };
    /**
     * Created popUps for all features by type of layers
     * Adding event on 'mouseover'
     * @param features
     */
    /**
     * Created popUps for all features by type of layers
     * Adding event on 'mouseover'
     * @param {?} features
     * @return {?}
     */
    AtlasMapComponent.prototype.createPopups = /**
     * Created popUps for all features by type of layers
     * Adding event on 'mouseover'
     * @param {?} features
     * @return {?}
     */
    function (features) {
        var _this = this;
        var e_2, _a;
        try {
            for (var _b = __values(this.findUniqueLayers(features)), _c = _b.next(); !_c.done; _c = _b.next()) {
                var item = _c.value;
                if (this.popupTemplate) {
                    this.map.addEventListener('mouseover', item, function (e) {
                        /** @type {?} */
                        var amFeature = features.find(function (it) { return it.dataElement.name === e.features[0].properties.name; });
                        _this.createComponent({
                            /**
                                         * sent to template variable
                                         * raw data from input
                                         */
                            dataElement: amFeature.dataElement
                        });
                        _this.popupAtlas.setPopupOptions({
                            position: e.features[0].geometry.coordinates,
                            content: document.getElementById("popupWrapper"),
                        });
                        _this.popupAtlas.open(_this.map);
                    });
                }
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_2) throw e_2.error; }
        }
    };
    /**
     * @param {?} features
     * @return {?}
     */
    AtlasMapComponent.prototype.updatePoints = /**
     * @param {?} features
     * @return {?}
     */
    function (features) {
        var _this = this;
        this.map.removeLayers(this.findUniqueLayers(features));
        if (this.cssArray.length) {
            this.cssArray.forEach(function (value) {
                (/** @type {?} */ (document.querySelectorAll("#" + value))).forEach(function (it) { return it.remove(); });
                _this.map.removeHtml(value);
            });
            this.cssArray = [];
        }
        this.createPoints(features);
    };
    /**
     * @return {?}
     */
    AtlasMapComponent.prototype.removeMap = /**
     * @return {?}
     */
    function () {
        this.map.remove();
    };
    AtlasMapComponent.decorators = [
        { type: Component, args: [{
                    selector: 'am-map',
                    template: "<div #mapWrapper class=\"atlas-map\"></div>\n\n<div id=\"popupWrapper\">\n  <div #popupsContainer>\n  </div>\n</div>\n\n\n\n\n",
                    styles: [".atlas-map{position:relative;width:100%;height:100%}"]
                },] },
    ];
    /** @nocollapse */
    AtlasMapComponent.ctorParameters = function () { return [
        { type: LoadMapService }
    ]; };
    AtlasMapComponent.propDecorators = {
        initialConfig: [{ type: Input }],
        _id: [{ type: Input }],
        onMapClick: [{ type: Output }],
        loaded: [{ type: Output }],
        popupsContainer: [{ type: ViewChild, args: ['popupsContainer', { read: ViewContainerRef },] }],
        mapWrapper: [{ type: ViewChild, args: ['mapWrapper', { read: ElementRef },] }],
        popupTemplate: [{ type: ContentChild, args: [AtlasPopupDirective, { read: TemplateRef },] }]
    };
    return AtlasMapComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
var AmModule = /** @class */ (function () {
    function AmModule() {
    }
    /**
     * @return {?}
     */
    AmModule.forRoot = /**
     * @return {?}
     */
    function () {
        return {
            ngModule: AmModule,
            providers: [
                LoadMapService
            ]
        };
    };
    AmModule.decorators = [
        { type: NgModule, args: [{
                    imports: [
                        CommonModule,
                    ],
                    declarations: [AtlasMapComponent, AtlasPopupDirective],
                    exports: [
                        AtlasMapComponent,
                        AtlasPopupDirective,
                    ],
                    bootstrap: [AtlasMapComponent]
                },] },
    ];
    return AmModule;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */

export { AmModule, AtlasMapComponent, LoadMapService, AtlasPopupDirective as ɵa };

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYWNhaXNvZnQtYW5ndWxhci1henVyZS1tYXBzLmpzLm1hcCIsInNvdXJjZXMiOlsibmc6Ly9AYWNhaXNvZnQvYW5ndWxhci1henVyZS1tYXBzL3NyYy9henVyZS1tYXAvZGlyZWN0aXZlcy9hdGxhcy1wb3B1cC5kaXJlY3RpdmUudHMiLCJuZzovL0BhY2Fpc29mdC9hbmd1bGFyLWF6dXJlLW1hcHMvc3JjL2F6dXJlLW1hcC91dGlscy9henVyZS1tYXAtbGF6eS1sb2FkZXIudHMiLCJuZzovL0BhY2Fpc29mdC9hbmd1bGFyLWF6dXJlLW1hcHMvc3JjL2F6dXJlLW1hcC91dGlscy9sb2FkLW1hcC5zZXJ2aWNlLnRzIiwibmc6Ly9AYWNhaXNvZnQvYW5ndWxhci1henVyZS1tYXBzL3NyYy9henVyZS1tYXAvYXRsYXMtbWFwL2F0bGFzLW1hcC5jb21wb25lbnQudHMiLCJuZzovL0BhY2Fpc29mdC9hbmd1bGFyLWF6dXJlLW1hcHMvc3JjL2F6dXJlLW1hcC9hbS5tb2R1bGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRGlyZWN0aXZlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbkBEaXJlY3RpdmUoe1xuICBzZWxlY3RvcjogJ1thbVBvcHVwXSdcbn0pXG5leHBvcnQgY2xhc3MgQXRsYXNQb3B1cERpcmVjdGl2ZSB7XG5cblxuICBjb25zdHJ1Y3RvcigpIHsgfVxuXG59XG4iLCJpbnRlcmZhY2UgU291cmNlIHtcbiAgdHlwZTogQXNzZXRUeXBlO1xuICBzcmM6IHN0cmluZztcbn1cblxuY29uc3Qgc291cmNlczogU291cmNlW10gPSBbXG4gICAge1xuICAgICAgICB0eXBlOiAnc3R5bGUnLFxuICAgICAgICBzcmM6ICdodHRwczovL2F0bGFzLm1pY3Jvc29mdC5jb20vc2RrL2Nzcy9hdGxhcy5taW4uY3NzP2FwaS12ZXJzaW9uPTEnXG4gICAgfSxcbiAgICB7XG4gICAgICAgIHR5cGU6ICdzY3JpcHQnLFxuICAgICAgICBzcmM6ICdodHRwczovL2F0bGFzLm1pY3Jvc29mdC5jb20vc2RrL2pzL2F0bGFzLm1pbi5qcz9hcGktdmVyc2lvbj0xJ1xuICAgIH1cbl07XG5cbmV4cG9ydCBmdW5jdGlvbiBfd2luZG93KCk6IGFueSB7XG4gICAgcmV0dXJuIHdpbmRvdztcbn1cblxuZXhwb3J0IHR5cGUgQXNzZXRUeXBlID0gJ3NjcmlwdCcgfCAnc3R5bGUnO1xuXG5leHBvcnQgZnVuY3Rpb24gbG9hZFNpbmdsZUFzc2V0KHNvdXJjZTogc3RyaW5nLCB0eXBlOiBBc3NldFR5cGUpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICBsZXQgY3JlYXRlZEVsZW1lbnQ7XG4gICAgICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgICAgICAgY2FzZSAnc2NyaXB0JzpcbiAgICAgICAgICAgICAgICBjcmVhdGVkRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpO1xuICAgICAgICAgICAgICAgIGNyZWF0ZWRFbGVtZW50LnNyYyA9IHNvdXJjZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3N0eWxlJzpcbiAgICAgICAgICAgICAgICBjcmVhdGVkRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpbmsnKTtcbiAgICAgICAgICAgICAgICBjcmVhdGVkRWxlbWVudC5yZWwgPSAnc3R5bGVzaGVldCc7XG4gICAgICAgICAgICAgICAgY3JlYXRlZEVsZW1lbnQuaHJlZiA9IHNvdXJjZTtcbiAgICAgICAgICAgICAgICBjcmVhdGVkRWxlbWVudC50eXBlID0gJ3RleHQvY3NzJztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmVqZWN0KCdXcm9uZyBUeXBlJyk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiAoX3dpbmRvdygpLmF0bGFzKSAhPT0gJ3VuZGVmaW5lZCdcbiAgICAgICAgICAgICYmIHR5cGVvZiAoX3dpbmRvdygpLmF0bGFzLk1hcCkgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY3JlYXRlZEVsZW1lbnQub25lcnJvciA9IHJlamVjdDtcbiAgICAgICAgICBjcmVhdGVkRWxlbWVudC5vbmxvYWQgPSByZXNvbHZlO1xuICAgICAgICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoY3JlYXRlZEVsZW1lbnQpO1xuICAgICAgICB9XG5cbiAgICB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGF6dXJlTWFwTGF6eUxvYWRlcigpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoc291cmNlcy5tYXAoc291cmNlID0+IGxvYWRTaW5nbGVBc3NldChzb3VyY2Uuc3JjLCBzb3VyY2UudHlwZSkpKTtcbn1cbiIsImltcG9ydCB7SW5qZWN0YWJsZX0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge2F6dXJlTWFwTGF6eUxvYWRlcn0gZnJvbSAnLi9henVyZS1tYXAtbGF6eS1sb2FkZXInO1xuaW1wb3J0IHtCZWhhdmlvclN1YmplY3QsIE9ic2VydmFibGUsIG9mLCBTdWJqZWN0fSBmcm9tICdyeGpzJztcbmltcG9ydCB7ZnJvbVByb21pc2V9IGZyb20gJ3J4anMvaW50ZXJuYWwtY29tcGF0aWJpbGl0eSc7XG5pbXBvcnQge2J9IGZyb20gJ0Bhbmd1bGFyL2NvcmUvc3JjL3JlbmRlcjMnO1xuXG5ASW5qZWN0YWJsZSgpXG5leHBvcnQgY2xhc3MgTG9hZE1hcFNlcnZpY2Uge1xuXG5cbiAgcHVibGljIGlzTG9hZGVkID0gZmFsc2U7XG5cbiAgcHVibGljIGlzQ29tcG9uZW50TG9hZGVkID0gZmFsc2VcblxuXG5cbiAgbG9hZGVkU3ViamVjdCA9IG5ldyBTdWJqZWN0PGJvb2xlYW4+KCk7XG4gIGxvYWRlZENvbXBvbmVuZXQgPSBuZXcgQmVoYXZpb3JTdWJqZWN0KGZhbHNlKVxuXG4gIGNvbnN0cnVjdG9yKCkge1xuICB9XG5cblxuICBsb2FkKCk6IE9ic2VydmFibGU8Ym9vbGVhbj4ge1xuICAgIGlmICghdGhpcy5pc0xvYWRlZCkge1xuICAgICAgcmV0dXJuIGZyb21Qcm9taXNlKGF6dXJlTWFwTGF6eUxvYWRlcigpLnRoZW4oKCkgPT4ge1xuICAgICAgICB0aGlzLmlzTG9hZGVkID0gdHJ1ZTtcbiAgICAgICAgcmV0dXJuIHRoaXMuaXNMb2FkZWQ7XG4gICAgICB9KSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBvZih0cnVlKTtcbiAgICB9XG4gIH1cblxuICBvYnNlcnZhYmxlQ29tcG9uZW50KCkge1xuICAgIHJldHVybiB0aGlzLmxvYWRlZFN1YmplY3QuYXNPYnNlcnZhYmxlKCk7XG4gIH1cbn1cbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi8uLi9hdGxhc1wiLz5cblxuaW1wb3J0IHtcbiAgQWZ0ZXJDb250ZW50SW5pdCxcbiAgQWZ0ZXJWaWV3SW5pdCxcbiAgQ29tcG9uZW50LFxuICBDb250ZW50Q2hpbGQsXG4gIEVsZW1lbnRSZWYsXG4gIEVtYmVkZGVkVmlld1JlZixcbiAgRXZlbnRFbWl0dGVyLFxuICBJbnB1dCxcbiAgT25Jbml0LFxuICBPdXRwdXQsXG4gIFRlbXBsYXRlUmVmLFxuICBWaWV3Q2hpbGQsXG4gIFZpZXdDb250YWluZXJSZWYsXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHtBbUZlYXR1cmV9IGZyb20gJy4uL2ludGVyZmFjZXMvYW0tZmVhdHVyZSc7XG5pbXBvcnQge0F0bGFzUG9wdXBEaXJlY3RpdmV9IGZyb20gJy4uL2RpcmVjdGl2ZXMvYXRsYXMtcG9wdXAuZGlyZWN0aXZlJztcbmltcG9ydCB7TG9hZE1hcFNlcnZpY2V9IGZyb20gJy4uL3V0aWxzL2xvYWQtbWFwLnNlcnZpY2UnO1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdhbS1tYXAnLFxuICB0ZW1wbGF0ZTogYDxkaXYgI21hcFdyYXBwZXIgY2xhc3M9XCJhdGxhcy1tYXBcIj48L2Rpdj5cblxuPGRpdiBpZD1cInBvcHVwV3JhcHBlclwiPlxuICA8ZGl2ICNwb3B1cHNDb250YWluZXI+XG4gIDwvZGl2PlxuPC9kaXY+XG5cblxuXG5cbmAsXG4gIHN0eWxlczogW2AuYXRsYXMtbWFwe3Bvc2l0aW9uOnJlbGF0aXZlO3dpZHRoOjEwMCU7aGVpZ2h0OjEwMCV9YF1cbn0pXG5leHBvcnQgY2xhc3MgQXRsYXNNYXBDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIEFmdGVyQ29udGVudEluaXQsIEFmdGVyVmlld0luaXQge1xuICBASW5wdXQoKSBpbml0aWFsQ29uZmlnOiBhbnk7XG4gIEBJbnB1dCgpIF9pZDogc3RyaW5nO1xuXG5cbiAgQE91dHB1dCgpIG9uTWFwQ2xpY2sgPSBuZXcgRXZlbnRFbWl0dGVyPGF0bGFzLmRhdGEuUG9zaXRpb24+KCk7XG4gIEBPdXRwdXQoKSBsb2FkZWQ6IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuXG4gIEBWaWV3Q2hpbGQoJ3BvcHVwc0NvbnRhaW5lcicsIHtyZWFkOiBWaWV3Q29udGFpbmVyUmVmfSkgcG9wdXBzQ29udGFpbmVyOiBWaWV3Q29udGFpbmVyUmVmO1xuICBAVmlld0NoaWxkKCdtYXBXcmFwcGVyJywge3JlYWQ6IEVsZW1lbnRSZWZ9KSBtYXBXcmFwcGVyOiBFbGVtZW50UmVmO1xuXG4gIC8qKlxuICAgKiBGb3IgY3JlYXRlIGFuZCBjb250cm9sIHBvcHVwXG4gICAqIFRvIEluamVjdCBpbnRvIG5nLXRlbXBsYXRlIGluIHBhcmVudFxuICAgKi9cbiAgQENvbnRlbnRDaGlsZChBdGxhc1BvcHVwRGlyZWN0aXZlLCB7cmVhZDogVGVtcGxhdGVSZWZ9KSBwb3B1cFRlbXBsYXRlOiBUZW1wbGF0ZVJlZjxhbnk+O1xuXG4gIHB1YmxpYyBwb3B1cFZpZXc6IEVtYmVkZGVkVmlld1JlZjxhbnk+O1xuICBwdWJsaWMgcG9wdXBBdGxhczogYXRsYXMuUG9wdXA7XG5cbiAgcHVibGljIG1hcDogYXRsYXMuTWFwO1xuICBwcml2YXRlIGN1c3RvbVBpbnM6IEFycmF5PGFueT4gPSBbXTtcbiAgcHVibGljIGZlYXR1cmVzOiBBbUZlYXR1cmVbXSA9IFtdOyAvLyBBcnJheSBvZiBvdXJzIHBvaW50cyB0byBhZGQgb24gbWFwXG4gIHByaXZhdGUgcG9pbnRzQXJyYXk6IGF0bGFzLmRhdGEuRmVhdHVyZVtdID0gW107XG4gIHByaXZhdGUgY3NzQXJyYXk6IHN0cmluZ1tdID0gW107XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSBtYXBTZXJ2aWNlOiBMb2FkTWFwU2VydmljZSkge1xuICB9XG5cbiAgbmdPbkluaXQoKTogdm9pZCB7XG4gICAgdGhpcy5wb3B1cEF0bGFzID0gbmV3IGF0bGFzLlBvcHVwKCk7XG4gICAgdGhpcy5tYXBTZXJ2aWNlLmxvYWRlZENvbXBvbmVuZXQubmV4dCh0cnVlKTtcblxuICB9XG5cbiAgbmdBZnRlckNvbnRlbnRJbml0KCk6IHZvaWQge1xuICAgIHRoaXMuY3JlYXRlTWFwKHRoaXMuX2lkLCB0aGlzLmluaXRpYWxDb25maWcpOyAvLyBJbml0aWFsIG1hcFxuICAgIHRoaXMuc3RhcnRNYXBDbGlja0xpc3RlbmVyKCk7IC8vIFN0YXJ0IGVtaXR0ZXJcbiAgfVxuXG4gIG5nQWZ0ZXJWaWV3SW5pdCgpOiB2b2lkIHtcbiAgICB0aGlzLmVtaXRMb2FkZWQoKTtcbiAgfVxuXG4gIGVtaXRMb2FkZWQoKSB7XG4gICAgaWYgKHRoaXMubWFwKSB7XG4gICAgICB0aGlzLmxvYWRlZC5lbWl0KCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNldFRpbWVvdXQodGhpcy5lbWl0TG9hZGVkLCAxMDApO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBjcmVhdGVNYXAoaWQ6IHN0cmluZywgY29uZmlnOiBhbnkpOiB2b2lkIHtcbiAgICB0cnkge1xuICAgICAgdGhpcy5tYXBXcmFwcGVyLm5hdGl2ZUVsZW1lbnQuc2V0QXR0cmlidXRlKCdpZCcsIGlkKTtcbiAgICAgIHRoaXMubWFwID0gbmV3IGF0bGFzLk1hcChpZCwgY29uZmlnKTsgLy8gSW5pdCBtYXAgYm94XG4gICAgICBjb25zb2xlLmxvZygnTWFwIHdhcyBjcmVhdGVkIScsIHRoaXMubWFwKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBjb25zb2xlLmxvZygnQ0hFQ0sgWU9VUiBDT05GSUchJywgZSk7XG4gICAgfVxuICB9XG5cbiAgY2hhbmdlTWFwQ2FtZXJhKG9wdGlvbnM6IENhbWVyYU9wdGlvbnMgJiBBbmltYXRpb25PcHRpb25zKTogdm9pZCB7XG4gICAgdGhpcy5tYXAuc2V0Q2FtZXJhKG9wdGlvbnMpO1xuICB9XG5cbiAgY2hhbmdlTWFwU3R5bGUob3B0aW9uczogU3R5bGVPcHRpb25zKTogdm9pZCB7XG4gICAgdGhpcy5tYXAuc2V0U3R5bGUob3B0aW9ucyk7XG4gIH1cblxuICBjaGFuZ2VVc2VySW50ZXJhY3Rpb24ob3B0aW9uczogVXNlckludGVyYWN0aW9uT3B0aW9ucyk6IHZvaWQge1xuICAgIHRoaXMubWFwLnNldFVzZXJJbnRlcmFjdGlvbihvcHRpb25zKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBGb3VuZGluZyBhbGwgdW5pcXVlIGxheWVycyBmcm9tIGZlYXR1cmVzIEFycmF5XG4gICAqIEBwYXJhbSBBbUZlYXR1cmVbXSBmZWF0dXJlc1xuICAgKiBAcmV0dXJucyBzdHJpbmdbXVxuICAgKi9cbiAgZmluZFVuaXF1ZUxheWVycyhmZWF0dXJlczogQW1GZWF0dXJlW10pOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgYWxsTGF5ZXJzID0gZmVhdHVyZXMubWFwKGl0ID0+IGl0LmxheWVyKTtcbiAgICByZXR1cm4gQXJyYXkuZnJvbShuZXcgU2V0KGFsbExheWVycykpO1xuICB9XG5cbiAgc3RhcnRNYXBDbGlja0xpc3RlbmVyKCk6IHZvaWQge1xuICAgIHRoaXMubWFwLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgIHRoaXMub25NYXBDbGljay5lbWl0KGUucG9zaXRpb24pO1xuICAgICAgLy8gT24gY2xpY2sgeW91IGVtaXQgZ2VvIHBvc2l0aW9uXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRpbmcgcG9wVXBDb250YWluZXIgYW5kIGluamVjdGVkIHRvIHBhcmVudCBUZW1wbGF0ZVxuICAgKiBAcGFyYW0gY29udGV4dFxuICAgKi9cbiAgY3JlYXRlQ29tcG9uZW50KGNvbnRleHQ6IGFueSk6IHZvaWQge1xuICAgIGlmICh0aGlzLnBvcHVwVmlldykge1xuICAgICAgdGhpcy5wb3B1cFZpZXcuZGVzdHJveSgpO1xuICAgIH1cbiAgICB0aGlzLnBvcHVwVmlldyA9IHRoaXMucG9wdXBzQ29udGFpbmVyLmNyZWF0ZUVtYmVkZGVkVmlldyh0aGlzLnBvcHVwVGVtcGxhdGUsIGNvbnRleHQpO1xuICB9XG5cbiAgYWRkSXRlbShpZCwgbG9jLCBjbGFzKTogdm9pZCB7XG4gICAgbGV0IGN1c3RvbUhUTUw7XG4gICAgY29uc3QgaWRJdGVtID0gY2xhcyArIGlkO1xuICAgIGNvbnN0IHBvcyA9IG5ldyBhdGxhcy5kYXRhLlBvc2l0aW9uKGxvYy5sbnQsIGxvYy5sbmcpO1xuICAgIHRoaXMuY3NzQXJyYXkucHVzaChpZEl0ZW0pOyAgLy8gU2F2aW5nIGV4aXN0aW5nIEhUTUwgZWxlbWVudHNcblxuICAgIGN1c3RvbUhUTUwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBjdXN0b21IVE1MLnNldEF0dHJpYnV0ZSgnaWQnLCBpZEl0ZW0pO1xuICAgIGN1c3RvbUhUTUwuc2V0QXR0cmlidXRlKCdjbGFzcycsIGNsYXMpO1xuXG4gICAgdGhpcy5tYXAuYWRkSHRtbChjdXN0b21IVE1MLCBwb3MpOyAvLyBhZGQgdG8gbWFwXG4gIH1cblxuICAvKipcbiAgICogRHJhd2luIHBvaW50IG9uIHRoZSBtYXAgYXMgcGluc1xuICAgKiBASW5jamV0IGNyZWF0ZVBvcHVwcygpXG4gICAqIEBwYXJhbSAgZmVhdHVyZXNcbiAgICovXG4gIGNyZWF0ZVBvaW50cyhmZWF0dXJlczogQW1GZWF0dXJlW10pOiB2b2lkIHtcbiAgICBpZiAoZmVhdHVyZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICBjb25zb2xlLmxvZygnTm8gZGF0YSBhdmFpbGFibGUnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgZmVhdHVyZXMpIHtcbiAgICAgIHRoaXMubWFwLmFkZFBpbnMoW2l0ZW0uYXRsYXNGZWF0dXJlXSwgaXRlbS5waW5Db25maWcpO1xuICAgICAgaWYgKGl0ZW0uYXRsYXNGZWF0dXJlLnByb3BlcnRpZXMuY3NzQ2xhc3MpIHtcbiAgICAgICAgdGhpcy5hZGRJdGVtKGl0ZW0uZGF0YUVsZW1lbnQuaWQsIGl0ZW0uZGF0YUVsZW1lbnQubG9jYWxpemF0aW9uLCBpdGVtLmF0bGFzRmVhdHVyZS5wcm9wZXJ0aWVzLmNzc0NsYXNzKTtcbiAgICAgICAgdGhpcy5jdXN0b21QaW5zLnB1c2goaXRlbS5hdGxhc0ZlYXR1cmUucHJvcGVydGllcy5jc3NDbGFzcyk7XG4gICAgICB9XG4gICAgICB0aGlzLnBvaW50c0FycmF5LnB1c2goaXRlbS5hdGxhc0ZlYXR1cmUpO1xuICAgIH1cbiAgICB0aGlzLmNyZWF0ZVBvcHVwcyhmZWF0dXJlcyk7XG4gIH1cblxuXG4gIC8qKlxuICAgKiBDcmVhdGVkIHBvcFVwcyBmb3IgYWxsIGZlYXR1cmVzIGJ5IHR5cGUgb2YgbGF5ZXJzXG4gICAqIEFkZGluZyBldmVudCBvbiAnbW91c2VvdmVyJ1xuICAgKiBAcGFyYW0gZmVhdHVyZXNcbiAgICovXG4gIGNyZWF0ZVBvcHVwcyhmZWF0dXJlczogQW1GZWF0dXJlW10pOiB2b2lkIHtcbiAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgdGhpcy5maW5kVW5pcXVlTGF5ZXJzKGZlYXR1cmVzKSkge1xuICAgICAgaWYgKHRoaXMucG9wdXBUZW1wbGF0ZSkge1xuICAgICAgICB0aGlzLm1hcC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW92ZXInLCBpdGVtLCAoZSkgPT4ge1xuICAgICAgICAgIGNvbnN0IGFtRmVhdHVyZTogQW1GZWF0dXJlID0gZmVhdHVyZXMuZmluZChpdCA9PiBpdC5kYXRhRWxlbWVudC5uYW1lID09PSBlLmZlYXR1cmVzWzBdLnByb3BlcnRpZXMubmFtZSk7XG4gICAgICAgICAgdGhpcy5jcmVhdGVDb21wb25lbnQoe1xuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBzZW50IHRvIHRlbXBsYXRlIHZhcmlhYmxlXG4gICAgICAgICAgICAgKiByYXcgZGF0YSBmcm9tIGlucHV0XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGRhdGFFbGVtZW50OiBhbUZlYXR1cmUuZGF0YUVsZW1lbnRcbiAgICAgICAgICB9KTtcbiAgICAgICAgICB0aGlzLnBvcHVwQXRsYXMuc2V0UG9wdXBPcHRpb25zKHtcbiAgICAgICAgICAgIHBvc2l0aW9uOiBlLmZlYXR1cmVzWzBdLmdlb21ldHJ5LmNvb3JkaW5hdGVzLFxuICAgICAgICAgICAgY29udGVudDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYHBvcHVwV3JhcHBlcmApLFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIHRoaXMucG9wdXBBdGxhcy5vcGVuKHRoaXMubWFwKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgdXBkYXRlUG9pbnRzKGZlYXR1cmVzOiBBbUZlYXR1cmVbXSk6IHZvaWQge1xuICAgIHRoaXMubWFwLnJlbW92ZUxheWVycyh0aGlzLmZpbmRVbmlxdWVMYXllcnMoZmVhdHVyZXMpKTtcbiAgICBpZiAodGhpcy5jc3NBcnJheS5sZW5ndGgpIHtcbiAgICAgIHRoaXMuY3NzQXJyYXkuZm9yRWFjaCh2YWx1ZSA9PiB7XG4gICAgICAgIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGAjJHt2YWx1ZX1gKSBhcyBhbnkpLmZvckVhY2goaXQgPT4gaXQucmVtb3ZlKCkpO1xuICAgICAgICB0aGlzLm1hcC5yZW1vdmVIdG1sKHZhbHVlKTtcbiAgICAgIH0pO1xuICAgICAgdGhpcy5jc3NBcnJheSA9IFtdO1xuICAgIH1cbiAgICB0aGlzLmNyZWF0ZVBvaW50cyhmZWF0dXJlcyk7XG4gIH1cblxuICByZW1vdmVNYXAoKSB7XG4gICAgdGhpcy5tYXAucmVtb3ZlKCk7XG4gIH1cblxuXG59XG5cblxuXG4iLCJpbXBvcnQge01vZHVsZVdpdGhQcm92aWRlcnMsIE5nTW9kdWxlfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IENvbW1vbk1vZHVsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5pbXBvcnQgeyBBdGxhc01hcENvbXBvbmVudCB9IGZyb20gJy4vYXRsYXMtbWFwL2F0bGFzLW1hcC5jb21wb25lbnQnO1xuaW1wb3J0IHsgQXRsYXNQb3B1cERpcmVjdGl2ZSB9IGZyb20gJy4vZGlyZWN0aXZlcy9hdGxhcy1wb3B1cC5kaXJlY3RpdmUnO1xuaW1wb3J0IHtMb2FkTWFwU2VydmljZX0gZnJvbSAnLi91dGlscy9sb2FkLW1hcC5zZXJ2aWNlJztcbmltcG9ydCB7QnJvd3Nlck1vZHVsZX0gZnJvbSAnQGFuZ3VsYXIvcGxhdGZvcm0tYnJvd3Nlcic7XG5cbkBOZ01vZHVsZSh7XG4gIGltcG9ydHM6IFtcbiAgICBDb21tb25Nb2R1bGUsXG4gIF0sXG4gIGRlY2xhcmF0aW9uczogW0F0bGFzTWFwQ29tcG9uZW50LCBBdGxhc1BvcHVwRGlyZWN0aXZlXSxcbiAgZXhwb3J0czogW1xuICAgIEF0bGFzTWFwQ29tcG9uZW50LFxuICAgIEF0bGFzUG9wdXBEaXJlY3RpdmUsXG4gIF0sXG4gIGJvb3RzdHJhcDogW0F0bGFzTWFwQ29tcG9uZW50XVxufSlcbmV4cG9ydCBjbGFzcyBBbU1vZHVsZSB7XG4gIHB1YmxpYyBzdGF0aWMgZm9yUm9vdCgpOiBNb2R1bGVXaXRoUHJvdmlkZXJzIHtcblxuICAgIHJldHVybiB7XG4gICAgICBuZ01vZHVsZTogQW1Nb2R1bGUsXG4gICAgICBwcm92aWRlcnM6IFtcbiAgICAgICAgTG9hZE1hcFNlcnZpY2VcbiAgICAgIF1cbiAgICB9O1xuICB9XG59XG4iXSwibmFtZXMiOlsidHNsaWJfMS5fX3ZhbHVlcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUFBO0lBUUU7S0FBaUI7O2dCQU5sQixTQUFTLFNBQUM7b0JBQ1QsUUFBUSxFQUFFLFdBQVc7aUJBQ3RCOzs7OzhCQUpEOzs7Ozs7OztBQ0tBLElBQU0sT0FBTyxHQUFhO0lBQ3RCO1FBQ0ksSUFBSSxFQUFFLE9BQU87UUFDYixHQUFHLEVBQUUsaUVBQWlFO0tBQ3pFO0lBQ0Q7UUFDSSxJQUFJLEVBQUUsUUFBUTtRQUNkLEdBQUcsRUFBRSwrREFBK0Q7S0FDdkU7Q0FDSixDQUFDOzs7O0FBRUY7SUFDSSxPQUFPLE1BQU0sQ0FBQztDQUNqQjs7Ozs7O0FBSUQseUJBQWdDLE1BQWMsRUFBRSxJQUFlO0lBQzNELE9BQU8sSUFBSSxPQUFPLENBQUMsVUFBQyxPQUFPLEVBQUUsTUFBTTs7UUFDL0IsSUFBSSxjQUFjLENBQUM7UUFDbkIsUUFBUSxJQUFJO1lBQ1IsS0FBSyxRQUFRO2dCQUNULGNBQWMsR0FBRyxRQUFRLENBQUMsYUFBYSxDQUFDLFFBQVEsQ0FBQyxDQUFDO2dCQUNsRCxjQUFjLENBQUMsR0FBRyxHQUFHLE1BQU0sQ0FBQztnQkFDNUIsTUFBTTtZQUNWLEtBQUssT0FBTztnQkFDUixjQUFjLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxNQUFNLENBQUMsQ0FBQztnQkFDaEQsY0FBYyxDQUFDLEdBQUcsR0FBRyxZQUFZLENBQUM7Z0JBQ2xDLGNBQWMsQ0FBQyxJQUFJLEdBQUcsTUFBTSxDQUFDO2dCQUM3QixjQUFjLENBQUMsSUFBSSxHQUFHLFVBQVUsQ0FBQztnQkFDakMsTUFBTTtZQUNWO2dCQUNJLE1BQU0sQ0FBQyxZQUFZLENBQUMsQ0FBQztnQkFDckIsTUFBTTtTQUNiO1FBQ0QsSUFBSSxRQUFRLE9BQU8sRUFBRSxDQUFDLEtBQUssQ0FBQyxLQUFLLFdBQVc7ZUFDckMsUUFBUSxPQUFPLEVBQUUsQ0FBQyxLQUFLLENBQUMs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